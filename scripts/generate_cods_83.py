from Bio.Seq import Seq
from Bio.SeqRecord import SeqRecord
from Bio import SeqIO
import os
import itertools

# Save FASTA in the same folder as this script
script_dir = os.path.dirname(os.path.abspath(__file__))
output_path = os.path.join(os.path.dirname(__file__), "codon83_variants.fasta")

# 83_S1 Serine at codon 83 reference gyrae for ecoli
AGC_83 = ("ATGAGCGATCTGGCGCGCGAAATTACCCCGGTGAACATTGAAGAAGAACTGAAAAGCAGCTATCTGGATT"
        "ATGCGATGAGCGTGATTGTGGGCCGCGCGCTGCCGGATGTGCGCGATGGCCTGAAACCGGTGCATCGCCG"
        "CGTGCTGTATGCGATGAACGTGCTGGGCAACGATTGGAACAAAGCGTATAAAAAAAGCGCGCGCGTGGTG"
        "GGCGATGTGATTGGCAAATATCATCCGCATGGCGATAGCGCGGTGTATGATACCATTGTGCGCATGGCGC"
        "AGCCGTTTAGCCTGCGCTATATGCTGGTGGATGGCCAGGGCAACTTTGGCAGCATTGATGGCGATAGCGC"
        "GGCGGCGATGCGCTATACCGAAATTCGCCTGGCGAAAATTGCGCATGAACTGATGGCGGATCTGGAAAAA"
        "GAAACCGTGGATTTTGTGGATAACTATGATGGCACCGAAAAAATTCCGGATGTGATGCCGACCAAAATTC"
        "CGAACCTGCTGGTGAACGGCAGCAGCGGCATTGCGGTGGGCATGGCGACCAACATTCCGCCGCATAACCT"
        "GACCGAAGTGATTAACGGCTGCCTGGCGTATATTGATGATGAAGATATTAGCATTGAAGGCCTGATGGAA"
        "CATATTCCGGGCCCGGATTTTCCGACCGCGGCGATTATTAACGGCCGCCGCGGCATTGAAGAAGCGTATC"
        "GCACCGGCCGCGGCAAAGTGTATATTCGCGCGCGCGCGGAAGTGGAAGTGGATGCGAAAACCGGCCGCGA"
        "AACCATTATTGTGCATGAAATTCCGTATCAGGTGAACAAAGCGCGCCTGATTGAAAAAATTGCGGAACTG"
        "GTGAAAGAAAAACGCGTGGAAGGCATTAGCGCGCTGCGCGATGAAAGCGATAAAGATGGCATGCGCATTG"
        "TGATTGAAGTGAAACGCGATGCGGTGGGCGAAGTGGTGCTGAACAACCTGTATAGCCAGACCCAGCTGCA"
        "GGTGAGCTTTGGCATTAACATGGTGGCGCTGCATCATGGCCAGCCGAAAATTATGAACCTGAAAGATATT"
        "ATTGCGGCGTTTGTGCGCCATCGCCGCGAAGTGGTGACCCGCCGCACCATTTTTGAACTGCGCAAAGCGC"
        "GCGATCGCGCGCATATTCTGGAAGCGCTGGCGGTGGCGCTGGCGAACATTGATCCGATTATTGAACTGAT"
        "TCGCCATGCGCCGACCCCGGCGGAAGCGAAAACCGCGCTGGTGGCGAACCCGTGGCAGCTGGGCAACGTG"
        "GCGGCGATGCTGGAACGCGCGGGCGATGATGCGGCGCGCCCGGAATGGCTGGAACCGGAATTTGGCGTGC"
        "GCGATGGCCTGTATTATCTGACCGAACAGCAGGCGCAGGCGATTCTGGATCTGCGCCTGCAGAAACTGAC"
        "CGGCCTGGAACATGAAAAACTGCTGGATGAATATAAAGAACTGCTGGATCAGATTGCGGAACTGCTGCGC"
        "ATTCTGGGCAGCGCGGATCGCCTGATGGAAGTGATTCGCGAAGAACTGGAACTGGTGCGCGAACAGTTTG"
        "GCGATAAACGCCGCACCGAAATTACCGCGAACAGCGCGGATATTAACCTGGAAGATCTGATTACCCAGGA"
        "AGATGTGGTGGTGACCCTGAGCCATCAGGGCTATGTGAAATATCAGCCGCTGAGCGAATATGAAGCGCAG"
        "CGCCGCGGCGGCAAAGGCAAAAGCGCGGCGCGCATTAAAGAAGAAGATTTTATTGATCGCCTGCTGGTGG"
        "CGAACACCCATGATCATATTCTGTGCTTTAGCAGCCGCGGCCGCGTGTATAGCATGAAAGTGTATCAGCT"
        "GCCGGAAGCGACCCGCGGCGCGCGCGGCCGCCCGATTGTGAACCTGCTGCCGCTGGAACAGGATGAACGC"
        "ATTACCGCGATTCTGCCGGTGACCGAATTTGAAGAAGGCGTGAAAGTGTTTATGGCGACCGCGAACGGCA"
        "CCGTGAAAAAAACCGTGCTGACCGAATTTAACCGCCTGCGCACCGCGGGCAAAGTGGCGATTAAACTGGT"
        "GGATGGCGATGAACTGATTGGCGTGGATCTGACCAGCGGCGAAGATGAAGTGATGCTGTTTAGCGCGGAA"
        "GGCAAAGTGGTGCGCTTTAAAGAAAGCAGCGTGCGCGCGATGGGCTGCAACACCACCGGCGTGCGCGGCA"
        "TTCGCCTGGGCGAAGGCGATAAAGTGGTGAGCCTGATTGTGCCGCGCGGCGATGGCGCGATTCTGACCGC"
        "GACCCAGAACGGCTATGGCAAACGCACCGCGGTGGCGGAATATCCGACCAAAAGCCGCGCGACCAAAGGC"
        "GTGATTAGCATTAAAGTGACCGAACGCAACGGCCTGGTGGTGGGCGCGGTGCAGGTGGATGATTGCGATC"
        "AGATTATGATGATTACCGATGCGGGCACCCTGGTGCGCACCCGCGTGAGCGAAATTAGCATTGTGGGCCG"
        "CAACACCCAGGGCGTGATTCTGATTCGCACCGCGGAAGATGAAAACGTGGTGGGCCTGCAGCGCGTGGCG"
        "GAACCGGTGGATGAAGAAGATCTGGATACCATTGATGGCAGCGCGGCGGAAGGCGATGATGAAATTGCGC"
        "CGGAAGTGGATGTGGATGATGAACCGGAAGAAGAA")

# Codon 83 start and stop positions
codon_index = 83
start = (codon_index - 1) * 3
end = start + 3

# Generate all 64 codons
nucleotides = ['A', 'C', 'G', 'T']
codons = [''.join(c) for c in itertools.product(nucleotides, repeat=3)]

# Create records with each codon substituted at position 83
records = []
for codon in codons:
    modified = AGC_83[:start] + codon + AGC_83[end:]
    record = SeqRecord(Seq(modified), id=f"83_{codon}", description="")
    records.append(record)

# Write all to a FASTA file
SeqIO.write(records, output_path, "fasta")

# debugging output path
print(f"Wrote {len(records)} sequences to {output_path}")
