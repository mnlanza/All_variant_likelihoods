print("hello")
print("Hello World")
install.packages(c(
"tidyverse",    # Core data manipulation & visualization tools
"readr",        # Reading CSVs
"readxl",       # Reading Excel files
"openxlsx",     # Writing Excel files
"ggplot2",      # Graphs
"dplyr",        # Data wrangling
"tidyr",        # Data reshaping
"stringr",      # String manipulation
"lubridate",    # Dates/times
"janitor",      # Clean messy data
"here",         # Easy file paths
"skimr",        # Quick data summary
"data.table",   # Fast data manipulation
"glue"          # String interpolation
))
install.packages(c(
"tidyverse",    # Core data manipulation & visualization tools
"readr",        # Reading CSVs
"readxl",       # Reading Excel files
"openxlsx",     # Writing Excel files
"ggplot2",      # Graphs
"dplyr",        # Data wrangling
"tidyr",        # Data reshaping
"stringr",      # String manipulation
"lubridate",    # Dates/times
"janitor",      # Clean messy data
"here",         # Easy file paths
"skimr",        # Quick data summary
"data.table",   # Fast data manipulation
"glue",          # String interpolation
"BiocManager",  # Needed to install bio packages
"caret",        # Machine learning framework
"randomForest", # Classic ML method
"shiny",        # For web dashboards
"plotly",       # Interactive plots
"ggpubr"        # Publication-ready plots
))
cat("\014")
5+6
a<-5
print(a)
sum(a,b)
a <-5
sum(a,b)
sum(a,b)
source("~/.active-rstudio-document")
sum(a,b)
sum(a,b)
name <- c("Greg", "Gill")
name
name <- c("Greg", "Gill")
name
name <- c("Greg", "Gill")
name
name <- c("Greg", "Gill")
name
source("~/.active-rstudio-document")
5+6
a <- 5
b <- 4
print(a)
sum(a,b)
name <- c("Greg", "Gill")
name
5+6
a <- 5
b <- 4
print(a)
sum(a,b)
name <- c("Greg", "Gill")
name
friends <- data.frame(name, age, gender)
name <- c("Greg", "Gill")
age <- c(47, 52, 35)
gender <- c("M", "F", "F")
friends <- data.frame(name, age, gender)
name <- c("Greg", "Paul", "Kim")
friends <- data.frame(name, age, gender)
View(friends)
View(friends)
gender <- c("M", "M", "F")
friends <- data.frame(name, age, gender)
View(friends)
friends$name
friends[1,"Greg"]
friends[friends$age<50, 1:2]
install.packages("tidyverse")
library(tidyverse)
friends %>%
select(name,age) %>%
filter(age < 50) %>%
arrange (age)
install.packages("dslabs")
require("dslabs")
require("dslabs")
require("dslabs")
require("ggplot2")
(require("dslabs"))
(require("ggplot2"))
installed.packages()
sum(installed.packages()[, "LibPath"] |> unique() |> sapply(function(p) sum(file.info(list.files(p, recursive = TRUE, full.names = TRUE))$size))) / (1024^2)
library("tidyverse")
library("dslabs")
data(movielens)
source("~/Desktop/Relman_lab/edxDataAnalysiscourse/testing.r", echo = TRUE)
log2(8)
log(8, base = 2)
log(8,2)
data()
murders
murders$populations
murders$population
sort(murders$total)
sort(murders$state)
num_murders_ordered <- order(murders$total)
murders$state[num_murders_ordered]
num_murders_ordered
murders$state[which.max(murders$population)]
a <- 2
b <- -1
c <- -4
-b + sqrt(b^2-4ac)/(2a)
(-b + sqrt(b^2-4*a*c))/(2*a)
(-b - sqrt(b^2-4*a*c))/(2*a)
log4(1024)
log2(1024)
log(1024,4)
murders %>%
ggplot(aes(population, total, label=abb, color=region)) +
geom_label()
data(movielens)
movielens
length(movielens)
nrow(movielens)
type(movielens$title)
class(movielens$title)
class(movielens$genres)
levels(movielens$genres)
nlevels(movielens$genres)
hours <- time/60
class(time)
hours <- as.numeric(time)/60
time <- c(10, 30, 40, 50)
time <- as.numeric(time)
hours <- time/60
mph <- distance/hours
distance <- c(0.8, 3.1, 2.8, 4.0)
time <- c(10, 30, 40, 50)
time <- as.numeric(time)
hours <- time/60
mph <- distance/hours
mph["mandy"]
mph[which("Mandi")]
mph[which(name == "Mandi")]
name <- c("Mandi", "Amy", "Nicole", "Olivia")
distance <- c(0.8, 3.1, 2.8, 4.0)
time <- c(10, 30, 40, 50)
time <- as.numeric(time)
hours <- time/60
mph <- distance/hours
mph[which(name == "Mandi")]
name[which.max(mph)]
time[which(name == olivia)]
time[which(name == Olivia)]
time[which(name == Olivia)]
time[which(name == "Olivia")]
hours[which(name == "Olivia")]
data(olive)
head(olive)
plot(olive$palmitic, olive$palmitoleic)
hist(olive$eicosenoic)
library(ggplot2)
boxplot(olive$region ~ olive$palmitic)
boxplot(olive$palmitic ~ olive$region)
# installing and loading the dplyr package
install.packages("dplyr")
library(dplyr)
# adding a column with mutate
library(dslabs)
data("murders")
murders
install.packages("dplyr")
murders <- mutate(murders, rate = total / population * 100000)
murders
source("~/Desktop/Relman_lab/All_variant_likelihoods/gyrae_83_all.R", echo = TRUE)
# getting vector with amino acids
amino_acids <- unique(as.vector(codon_table_11))
# making a new vector with amino acids as names and 0's for relative likelihoods
aa_rel_ls <- setNames(numeric(length(amino_acids)), amino_acids)
# iterating to add relative likelihood values to aa_counts
for (name in seq_names){
codon <- substr(name, 4, 6)
aa <- codon_table_11[codon]
aa_rel_ls[aa] <- aa_rel_ls[aa] + rel_ls[name]
}
plot_aa_ls <- function(){
df_norm_aa <- data.frame(
amino_acids = names(aa_rel_ls),
aa_rel_ls = aa_rel_ls
)
ggplot(df_norm_aa, aes(x = aa_rel_ls, y = amino_acids)) +
geom_col(fill = "steelblue") +
theme_minimal(base_size = 14) +
labs(x = "Relative amino acid likelihood", y = "Amino acids",
title = "Normalized (relative) amino acids per gene")
}
plot_aa_ls()
codon_table_11
save_as_pdf_12x5(plot_norm_ll(), Norm_codon_ls, out_dir = "My_figures")
save_as_pdf_12x5(plot_aa_ls(), Norm_aa_ls, out_dir = "My_figures")
save_as_pdf_12x5(plot_norm_ll(), "Norm_codon_ls", out_dir = "My_figures")
save_as_pdf_12x5(plot_aa_ls(), "Norm_aa_ls", out_dir = "My_figures")
save_as_pdf_12x5(plot_norm_ll(), "Norm_codon_ls.pdf", out_dir = "My_figures")
save_as_pdf_12x5(plot_aa_ls(), "Norm_aa_ls.pdf", out_dir = "My_figures")
save_as_pdf(plot_norm_ll(), "Norm_codon_ls.pdf", out_dir = "My_figures", height = 10)
source("~/Desktop/Relman_lab/EVO2_Exercise/ML_EVO2_Exercise.R")
setwd("~/Desktop/Relman_lab/All_variant_likelihoods")
save_as_pdf(plot_norm_ll(), "Norm_codon_ls.pdf", out_dir = "My_figures", height = 10)
save_as_pdf(plot_norm_ll(), "Norm_codon_ls.pdf", out_dir = "My_figures", width = 10, height = 8)
save_as_pdf(plot_norm_ll(), "Norm_codon_ls.pdf", out_dir = "My_figures", width = 10, height = 6.5)
save_as_pdf(plot_norm_ll(), "Norm_codon_ls.pdf", out_dir = "My_figures", width = 10, height = 7)
plot_norm_ll <- function(){
# turn into a dataframe for plotting
df_norm <- data.frame(
gene   = names(rel_ls),
rel_l = rel_ls
)
# ggplot bar‐plot
ggplot(df_norm, aes(x = gene, y = rel_l)) +
geom_col(fill = "steelblue") +
theme_minimal(base_size = 16) +
labs(x = "Gene variant", y = "Relative likelihood",
title = "Normalized (relative) likelihood per gene") +
theme(axis.text.y = element_text(size = 8))
}
# plotting normalized log-likelihoods
plot_norm_ll()
plot_norm_ll <- function(){
# turn into a dataframe for plotting
df_norm <- data.frame(
gene   = names(rel_ls),
rel_l = rel_ls
)
# ggplot bar‐plot
ggplot(df_norm, aes(x = gene, y = rel_l)) +
geom_col(fill = "steelblue") +
coord_flip() +
theme_minimal(base_size = 16) +
labs(x = "Gene variant", y = "Relative likelihood",
title = "Normalized (relative) likelihood per gene") +
theme(axis.text.y = element_text(size = 8))
}
plot_norm_ll <- function(){
# turn into a dataframe for plotting
df_norm <- data.frame(
gene   = names(rel_ls),
rel_l = rel_ls
)
# ggplot bar‐plot
ggplot(df_norm, aes(x = gene, y = rel_l)) +
geom_col(fill = "steelblue") +
coord_flip() +
theme_minimal(base_size = 16) +
labs(x = "Gene variant", y = "Relative likelihood",
title = "Normalized (relative) likelihood per gene") +
theme(axis.text.y = element_text(size = 8))
}
# plotting normalized log-likelihoods
plot_norm_ll()
save_as_pdf(plot_norm_ll(), "Norm_codon_ls.pdf", out_dir = "My_figures", width = 10, height = 6.7)
source("~/Desktop/Relman_lab/All_variant_likelihoods/gyrae_83_all.R", echo = TRUE)
source("~/Desktop/Relman_lab/All_variant_likelihoods/gyrae_83_all.R", echo = TRUE)
source("~/Desktop/Relman_lab/All_variant_likelihoods/gyrae_83_all.R", echo = TRUE)
library(Biostrings)
library(ggplot2)
source("~/Desktop/Relman_lab/EVO2_Exercise/ML_EVO2_Exercise.R")
setwd("~/Desktop/Relman_lab/All_variant_likelihoods")
source("~/Desktop/Relman_lab/All_variant_likelihoods/gyrae_83_all.R", echo = TRUE)
seq_names
all_variants <- readDNAStringSet("Double_genes/double_resist_genes.fasta")
seq_names <- names(all_variants)
seq_names
get_dfs <- function(){
dfs <- list()
for (name in seq_names){
npy_fn <- paste0("Double_genes/double-resist-genes-v1/output/input_", name, "_logits.npy")
dfs[[name]] <- initialize_df(npy_fn, name)
}
return(dfs)
}
get_dfs
get_dfs
get_dfs
p <- get_dfs
p
get_dfs()
plot_log_likelihood("double_83_ref", dfs[[double_83_ref]], index_rows  = 200:300, highlighted = 247:249)
dfs <- dfs()
dfs <- get_dfs()
plot_log_likelihood("double_83_ref", dfs[[double_83_ref]], index_rows  = 200:300, highlighted = 247:249)
dfs <- get_dfs()
source("~/Desktop/Relman_lab/All_variant_likelihoods/EVO_learned_resist.R", echo = TRUE)
seq_names
plot_log_likelihood("double_83_TTT", dfs$double_83_TTT, index_rows  = 200:300, highlighted = 247:249)
plot_log_likelihood("double_83_ref", dfs$double_83_ref, index_rows  = (200+2625):(300+2625),
highlighted = (2625+247):(2625+249))
plot_log_likelihood("double_83_ref", dfs$double_83_ref, index_rows  = 200:300, highlighted = 247:249)
plot_log_likelihood("double_83_ref", dfs$double_83_ref, index_rows  = (200+2625):(300+2625),
highlighted = (2625+247):(2625+249))
plot_log_likelihood("double_83_TTT", dfs$double_83_TTT, index_rows  = 200:300, highlighted = 247:249)
plot_log_likelihood("double_83_TTT", dfs$double_83_TTT, index_rows  = (200+2625):(300+2625),
highlighted = (2625+247):(2625+249))
plot_log_likelihood("double_83_ref", dfs$double_83_ref, index_rows  = (200+2625):(300+2625),
highlighted = (2625+247):(2625+249))
source("~/Desktop/Relman_lab/All_variant_likelihoods/gyrae_83_all.R", echo = TRUE)
source("~/Desktop/Relman_lab/All_variant_likelihoods/EVO_learned_resist.R", echo = TRUE)
source("~/Desktop/Relman_lab/All_variant_likelihoods/EVO_learned_resist.R", echo = TRUE)
dfs <- get_dfs()
library(Biostrings)
library(ggplot2)
source("~/Desktop/Relman_lab/All_variant_likelihoods/gyrae_83_all.R")
setwd("~/Desktop/Relman_lab/All_variant_likelihoods")
all_variants <- readDNAStringSet("Double_genes/double_resist_genes.fasta")
seq_names <- names(all_variants)
"seq_names: double_83_ref double_83_TTT "
get_dfs <- function(){
dfs <- list()
for (name in seq_names){
npy_fn <- paste0("Double_genes/double-resist-genes-v1/output/input_", name, "_logits.npy")
dfs[[name]] <- initialize_df(npy_fn, name)
}
return(dfs)
}
dfs <- get_dfs()
vec <- get_tot_lls(dfs)
vec
dfs
all_gene_dfs <- get_dfs()
total_ll_vec <- numeric(length(all_gene_dfs))
total_ll_vec
dfs <- get_dfs()
get_tot_lls_2625(dfs)
get_tot_lls_2625 <- function(all_gene_dfs){
# initialize vec of length all_genes_dfs to store total ll
total_ll_vec <- numeric(length(all_gene_dfs))
names(total_ll_vec) <- names(all_gene_dfs)
for (i in 1:length(all_gene_dfs)) {
firsth_ll_vec[i] <- sum(all_gene_dfs[[i]]$log_likelihood[1:2625])
secondh_ll_vec[i+2] <- sum(all_gene_dfs[[i]]$log_likelihood[1:2625])
}
return(total_ll_vec)
}
dfs <- get_dfs()
get_tot_lls_2625(dfs)
get_diff_lls_2625 <- function(all_gene_dfs){
# initialize first half vec
firsth_ll_vec <- numeric(length(all_gene_dfs))
names(firsth_ll_vec) <- names(all_gene_dfs)
# initialize second half vec
secondh_ll_vec <- numeric(length(all_gene_dfs))
names(secondh_ll_vec) <- paste0("secondh_", names(all_gene_dfs))
for (i in 1:length(all_gene_dfs)) {
firsth_ll_vec[i] <- sum(all_gene_dfs[[i]]$log_likelihood[1:2625])
secondh_ll_vec[i] <- sum(all_gene_dfs[[i]]$log_likelihood[1:2625])
}
return(firsth_ll_vec-secondh_ll_vec)
}
dfs <- get_dfs()
get_tot_lls_2625(dfs)
get_diff_lls_2625 <- function(all_gene_dfs){
# initialize first half vec
firsth_ll_vec <- numeric(length(all_gene_dfs))
names(firsth_ll_vec) <- names(all_gene_dfs)
# initialize second half vec
secondh_ll_vec <- numeric(length(all_gene_dfs))
names(secondh_ll_vec) <- paste0("secondh_", names(all_gene_dfs))
for (i in 1:length(all_gene_dfs)) {
firsth_ll_vec[i] <- sum(all_gene_dfs[[i]]$log_likelihood[1:2625])
secondh_ll_vec[i] <- sum(all_gene_dfs[[i]]$log_likelihood[1:2625])
}
return(firsth_ll_vec-secondh_ll_vec)
}
dfs <- get_dfs()
get_diff_lls_2625(dfs)
all_gene_dfs <- get_dfs()
all_gene_dfs
firsth_ll_vec <- numeric(length(all_gene_dfs))
firsth_ll_vec
names(firsth_ll_vec) <- names(all_gene_dfs)
names(firsth_ll_vec)
# initialize second half vec
secondh_ll_vec <- numeric(length(all_gene_dfs))
secondh_ll_vec
names(secondh_ll_vec) <- paste0("secondh_", names(all_gene_dfs))
names(secondh_ll_vec)
get_diff_lls_2625 <- function(all_gene_dfs){
# initialize first half vec
firsth_ll_vec <- numeric(length(all_gene_dfs))
firsth_ll_vec
names(firsth_ll_vec) <- names(all_gene_dfs)
names(firsth_ll_vec)
# initialize second half vec
secondh_ll_vec <- numeric(length(all_gene_dfs))
secondh_ll_vec
names(secondh_ll_vec) <- paste0("secondh_", names(all_gene_dfs))
names(secondh_ll_vec)
for (i in 1:length(all_gene_dfs)) {
firsth_ll_vec[i] <- sum(all_gene_dfs[[i]]$log_likelihood[1:2625])
secondh_ll_vec[i] <- sum(all_gene_dfs[[i]]$log_likelihood[(1+2625):(2625+2625)])
}
return(firsth_ll_vec-secondh_ll_vec)
}
dfs <- get_dfs()
get_diff_lls_2625(dfs)
get_diff_lls_2625 <- function(all_gene_dfs){
# initialize first half vec
firsth_ll_vec <- numeric(length(all_gene_dfs))
firsth_ll_vec
names(firsth_ll_vec) <- names(all_gene_dfs)
names(firsth_ll_vec)
# initialize second half vec
secondh_ll_vec <- numeric(length(all_gene_dfs))
secondh_ll_vec
names(secondh_ll_vec) <- paste0("secondh_", names(all_gene_dfs))
names(secondh_ll_vec)
for (i in 1:length(all_gene_dfs)) {
firsth_ll_vec[i] <- sum(all_gene_dfs[[i]]$log_likelihood[1:2625])
secondh_ll_vec[i] <- sum(all_gene_dfs[[i]]$log_likelihood[(1+2625):(2625+2625)])
}
return(firsth_ll_vec)
}
dfs <- get_dfs()
get_diff_lls_2625(dfs)
get_diff_lls_2625 <- function(all_gene_dfs){
# initialize first half vec
firsth_ll_vec <- numeric(length(all_gene_dfs))
firsth_ll_vec
names(firsth_ll_vec) <- names(all_gene_dfs)
names(firsth_ll_vec)
# initialize second half vec
secondh_ll_vec <- numeric(length(all_gene_dfs))
secondh_ll_vec
names(secondh_ll_vec) <- paste0("secondh_", names(all_gene_dfs))
names(secondh_ll_vec)
for (i in 1:length(all_gene_dfs)) {
firsth_ll_vec[i] <- sum(all_gene_dfs[[i]]$log_likelihood[1:2625])
secondh_ll_vec[i] <- sum(all_gene_dfs[[i]]$log_likelihood[(1+2625):(2625+2625)])
}
return(secondh_ll_vec-firsth_ll_vec)
}
dfs <- get_dfs()
get_diff_lls_2625(dfs)
plot_log_likelihood("double_83_ref", dfs$double_83_ref, index_rows  = 1:2625, highlighted = 247:249)
2625*2
plot_log_likelihood("double_83_ref", dfs$double_83_ref, index_rows  = 1:5250, highlighted = 247:249)
plot_log_likelihood("double_83_TTT", dfs$double_83_TTT, index_rows  = 1:5250, highlighted = 247:249)
getwd()
save_as_pdf(plot_log_likelihood("double_83_ref", dfs$double_83_ref, index_rows  = 1:5250,
highlighted = 247:249), "2x_83_S1", out_dir = "Double_genes/My_figures", width = 12, height = 5)
save_as_pdf(plot_log_likelihood("double_83_ref.pdf", dfs$double_83_ref, index_rows  = 1:5250,
highlighted = 247:249), "2x_83_S1", out_dir = "Double_genes/My_figures", width = 12, height = 5)
save_as_pdf(plot_log_likelihood("double_83_ref", dfs$double_83_ref, index_rows  = 1:5250,
highlighted = 247:249), "2x_83_S1.pdf", out_dir = "Double_genes/My_figures", width = 12, height = 5)
save_as_pdf(plot_log_likelihood("double_83_TTT", dfs$double_83_TTT, index_rows  = 1:5250,
highlighted = 247:249) , "2x_83_TTT.pdf", out_dir = "Double_genes/My_figures", width = 12, height = 5)
save_as_pdf(plot_log_likelihood("83_ref", dfs$double_83_ref, index_rows  = 200:300,
highlighted = 247:249), "83_ref.pdf", out_dir = "Double_genes/My_figures", width = 12, height = 5)
save_as_pdf(plot_log_likelihood("83_2nd", dfs$double_83_ref, index_rows  = (200+2625):(300+2625),
highlighted = (2625+247):(2625+249)), "83_2nd.pdf", out_dir = "Double_genes/My_figures", width = 12, height = 5)
save_as_pdf(plot_log_likelihood("83_TTT_ref", dfs$double_83_TTT, index_rows  = 200:300,
highlighted = 247:249), "83_TTT_ref.pdf", out_dir = "Double_genes/My_figures", width = 12, height = 5)
save_as_pdf(plot_log_likelihood("83_TTT_2nd", dfs$double_83_TTT, index_rows  = 200:300,
highlighted = (2625+247):(2625+249)), "83_TTT_2nd.pdf", out_dir = "Double_genes/My_figures", width = 12, height = 5)
save_as_pdf(plot_log_likelihood("83_TTT_2nd", dfs$double_83_TTT, index_rows  = 200:300,
highlighted = (2625+247):(2625+249)), "83_TTT_2nd.pdf", out_dir = "Double_genes/My_figures", width = 12, height = 5)
save_as_pdf(plot_log_likelihood("83_TTT_2nd", dfs$double_83_TTT, index_rows  = (2625+247):(2625+249),
highlighted = (2625+247):(2625+249)), "83_TTT_2nd.pdf", out_dir = "Double_genes/My_figures", width = 12, height = 5)
save_as_pdf(plot_log_likelihood("83_TTT_2nd", dfs$double_83_TTT, index_rows  = (2625+200):(2625+300),
highlighted = (2625+247):(2625+249)), "83_TTT_2nd.pdf", out_dir = "Double_genes/My_figures", width = 12, height = 5)
plot_log_likelihood("double_83_TTT", dfs$double_83_TTT, index_rows  = (200+2625):(300+2625),
highlighted = (2625+1):(2625+100))
plot_log_likelihood("double_83_TTT", dfs$double_83_TTT, index_rows  = (200+2625):(300+2625),
highlighted = (2600):(2625+100))
plot_log_likelihood("double_83_TTT", dfs$double_83_TTT, index_rows  = (200+2625):(300+2625),
highlighted = (2600):(2625+100))
plot_log_likelihood("double_83_TTT", dfs$double_83_TTT, index_rows  = (2600):(2625+100),
highlighted = (2600):(2625+100))
plot_log_likelihood("double_83_TTT", dfs$double_83_TTT, index_rows  = (2625):(2625+100),
highlighted = (2600):(2625+100))
save_as_pdf(plot_log_likelihood("trans_83_TTT", dfs$double_83_TTT, index_rows  = (2620):(2600+100)),
highlighted = (2625+247):(2625+249), "trans_83_TTT.pdf", out_dir = "Double_genes/My_figures", width = 12, height = 5)
save_as_pdf(plot_log_likelihood("trans_83_TTT", dfs$double_83_TTT, index_rows  = (2620):(2600+100),
highlighted = (2625+247):(2625+249)), "trans_83_TTT.pdf", out_dir = "Double_genes/My_figures", width = 12, height = 5)
save_as_pdf(plot_log_likelihood("trans_83_S1", dfs$double_83_ref, index_rows  = (2620):(2600+100),
highlighted = (2625+247):(2625+249)), "trans_83_S1.pdf", out_dir = "Double_genes/My_figures", width = 12, height = 5)
